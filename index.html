<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>עטרת שלמה</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
            text-align: center;
        }
        header {
            background-color: #007bff;
            color: white;
            padding: 20px;
            position: relative;
        }
        #logo {
            max-width: 200px;
            height: auto;
        }
        nav {
            background-color: #333;
            color: white;
            padding: 10px;
        }
        nav ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        nav ul li {
            margin: 10px;
        }
        nav ul li a {
            color: white;
            text-decoration: none;
        }
        .hamburger {
            display: none;
            cursor: pointer;
            font-size: 24px;
            color: white;
            position: absolute;
            top: 20px;
            right: 20px;
        }
        @media (max-width: 768px) {
            nav ul {
                display: none;
                flex-direction: column;
            }
            nav ul.active {
                display: flex;
            }
            .hamburger {
                display: block;
            }
        }
        .home {
            padding: 50px;
        }
        .home h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        .buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        .buttons button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            cursor: pointer;
            font-size: 1.2em;
            border-radius: 5px;
        }
        .buttons button:hover {
            background-color: #0056b3;
        }
        #counter-section {
            padding: 50px;
            background-color: #e9ecef;
        }
        #counter {
            font-size: 3em;
            font-weight: bold;
        }
        #shops-section {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .filter-container {
            margin-bottom: 20px;
        }
        .shops-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        .shop-card {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 10px;
            width: 300px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        .shop-card h3 {
            margin-top: 0;
        }
        .shop-card .details {
            display: none;
        }
        .shop-card.active .details {
            display: block;
        }
        @media (max-width: 768px) {
            .shop-card.active {
                position: relative;
                top: -50px; /* מעלה את הכרטיס למעלה בגלילה */
            }
        }
        footer {
            background-color: #333;
            color: white;
            padding: 10px;
            position: fixed;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>
<body>

<header>
    <img id="logo" src="לוגו מתוקן שקוף.png" alt="לוגו עטרת שלמה"> <!-- שם הקובץ כפי שהעלית לגיטהב -->
    <div class="hamburger" onclick="toggleMenu()">☰</div>
    <nav>
        <ul id="menu">
            <li><a href="#home">דף הבית</a></li>
            <li><a href="#shops">רשימת הסדרים</a></li>
            <!-- הוסף דפים נוספים אם צריך -->
        </ul>
    </nav>
</header>

<section id="home" class="home">
    <h1>עטרת שלמה</h1>
    <div class="buttons">
        <button onclick="location.href='#shops'">רשימת הסדרים</button>
        <button>לחצן נוסף</button>
    </div>
</section>

<section id="counter-section">
    <h2>מספר כלשהו</h2>
    <div id="counter">0</div>
</section>

<section id="shops" class="shops-section">
    <h2>רשימת הסדרים</h2>
    <div class="filter-container">
        <label for="category-filter">סנן לפי קטגוריה:</label>
        <select id="category-filter">
            <option value="">כל הקטגוריות</option>
        </select>
        <label for="city-filter">סנן לפי עיר:</label>
        <select id="city-filter">
            <option value="">כל הערים</option>
        </select>
        <input type="text" id="search-input" placeholder="חפש חנות...">
    </div>
    <div id="shops-container" class="shops-container"></div>
</section>

<footer>
    &copy; 2026 עטרת שלמה
</footer>

<script>
    function toggleMenu() {
        const menu = document.getElementById('menu');
        menu.classList.toggle('active');
    }

    const menuLinks = document.querySelectorAll('#menu a');
    menuLinks.forEach(link => {
        link.addEventListener('click', () => {
            if (window.innerWidth <= 768) {
                toggleMenu();
            }
        });
    });

    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRhzwU8YgPWoaIOVp9pSaKjdq8sO4OzAYxDsIiDqTLd9na3M1KVr3oPV4tvQ85y7chufAKTfQ8ghKMH/pub?output=csv';

    async function fetchShops() {
        try {
            const response = await fetch(csvUrl);
            const csvText = await response.text();
            const shops = parseCSV(csvText);
            renderShops(shops);
            populateFilters(shops);
        } catch (error) {
            console.error('שגיאה בטעינת נתונים:', error);
        }
    }

    function parseCSV(csv) {
        const lines = csv.split('\n');
        const headers = lines[0].split(',');
        const shops = [];
        for (let i = 1; i < lines.length; i++) {
            if (lines[i].trim() === '') continue;
            const values = lines[i].split(',');
            const shop = {};
            headers.forEach((header, index) => {
                shop[header.trim()] = values[index] ? values[index].trim() : '';
            });
            shops.push(shop);
        }
        return shops;
    }

    function renderShops(shops) {
        const container = document.getElementById('shops-container');
        container.innerHTML = '';
        shops.forEach(shop => {
            const card = document.createElement('div');
            card.className = 'shop-card';
            card.innerHTML = `
                <h3>${shop.name}</h3>
                <p><strong>קטגוריה:</strong> ${shop.cat}</p>
                <p><strong>עיר:</strong> ${shop.city}</p>
                <div class="details">
                    <p><strong>תיאור:</strong> ${shop.desc}</p>
                    <p><strong>הערות:</strong> ${shop.note}</p>
                </div>
            `;
            card.addEventListener('click', () => {
                card.classList.toggle('active');
                if (window.innerWidth <= 768 && card.classList.contains('active')) {
                    card.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
            container.appendChild(card);
        });
    }

    function populateFilters(shops) {
        const catSelect = document.getElementById('category-filter');
        const citySelect = document.getElementById('city-filter');
        const cats = new Set();
        const cities = new Set();
        shops.forEach(shop => {
            cats.add(shop.cat);
            cities.add(shop.city);
        });
        cats.forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat;
            catSelect.appendChild(option);
        });
        cities.forEach(city => {
            const option = document.createElement('option');
            option.value = city;
            option.textContent = city;
            citySelect.appendChild(option);
        });
    }

    document.getElementById('category-filter').addEventListener('change', filterShops);
    document.getElementById('city-filter').addEventListener('change', filterShops);
    document.getElementById('search-input').addEventListener('input', filterShops);

    let allShops = [];
    async function filterShops() {
        if (!allShops.length) {
            const response = await fetch(csvUrl);
            const csvText = await response.text();
            allShops = parseCSV(csvText);
        }
        const cat = document.getElementById('category-filter').value;
        const city = document.getElementById('city-filter').value;
        const search = document.getElementById('search-input').value.toLowerCase();
        const filtered = allShops.filter(shop => 
            (!cat || shop.cat === cat) &&
            (!city || shop.city === city) &&
            (shop.name.toLowerCase().includes(search) || shop.desc.toLowerCase().includes(search))
        );
        renderShops(filtered);
    }

    const counterSection = document.getElementById('counter-section');
    const counter = document.getElementById('counter');
    let animated = false;

    const observer = new IntersectionObserver(entries => {
        if (entries[0].isIntersecting && !animated) {
            animated = true;
            animateCounter(0, 180000, 2000);
        }
    });
    observer.observe(counterSection);

    function animateCounter(start, end, duration) {
        let startTime = null;
        function step(timestamp) {
            if (!startTime) startTime = timestamp;
            const progress = timestamp - startTime;
            const value = Math.min(start + (progress / duration) * (end - start), end);
            counter.textContent = Math.floor(value).toLocaleString();
            if (progress < duration) {
                requestAnimationFrame(step);
            }
        }
        requestAnimationFrame(step);
    }

    fetchShops();
</script>

</body>
</html>
